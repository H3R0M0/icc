{% extends '@Common/main.html.twig' %}

{% block userbar %}
    <div class="float-right d-print-none" id="userbar">
        {#
        {% if is_granted('ROLE_ADMIN') %}
            <div class="btn-group">
                <button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown">
                    <i class="fa fa-cogs"></i> {{ 'admin.settings.label'|trans }}
                </button>

                {{ knp_menu_render('settingsMenu', {'currentClass': 'active', 'template': 'dropdown_menu.html.twig' }) }}
            </div>

        <div class="btn-group">
            <button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-cogs"></i> {{ 'admin.label'|trans }}
            </button>

            {{ knp_menu_render('adminMenu', {'currentClass': 'active', 'template': 'dropdown_menu.html.twig' }) }}
        </div>
        {% endif %}
        #}

        {% if user.services|length > 0 %}
            <div class="btn-group">
                <button type="button" class="btn btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown">
                    <i class="fas fa-bars"></i> {{ 'services.label'|trans }}
                </button>

                <ul class="dropdown-menu" role="menu">

                    {% for service in user.services %}
                        <li>
                            <a class="dropdown-item" href="{{ service.url }}" target="_blank" title="{{ service.description }}">
                                {{ service.name }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block container %}
    <div class="navbar navbar-dark navbar-expand-lg bg-primary">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#menu">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse text-white" id="menu">
            {{ knp_menu_render(mainMenu, {'currentClass': 'active' }) }}

            {{ knp_menu_render('settingsMenu', {'currentClass': 'active' }) }}
            {{ knp_menu_render('adminMenu', {'currentClass': 'active' }) }}
            {{ knp_menu_render('userMenu', {'currentClass': 'active' }) }}
        </div>
    </div>
    <div class="navbar navbar-sub bg-danger mb-2">
        <div class="navbar text-white w-100" id="submenu">
            {{ knp_menu_render(mainMenu, {'currentClass': 'active', 'template': 'submenu.html.twig' }) }}

            {{ knp_menu_render('settingsMenu', {'currentClass': 'active', 'template': 'submenu.html.twig' }) }}
            {{ knp_menu_render('adminMenu', {'currentClass': 'active', 'template': 'submenu.html.twig' }) }}
            {{ knp_menu_render('userMenu', {'currentClass': 'active', 'template': 'submenu.html.twig' }) }}
        </div>
    </div>

    {% block breadcrumb %}{% endblock %}

    {% for msg in app.session.flashbag.get('error') %}
        <div class="bs-callout bs-callout-danger">
            <h4>{{ 'error.label'|trans }}</h4>
            <p>{{ msg|trans }}</p>
        </div>
    {% endfor %}

    {% for msg in app.session.flashbag.get('info') %}
        <div class="bs-callout bs-callout-info">
            <h4>{{ 'info.label'|trans }}</h4>
            <p>{{ msg|trans }}</p>
        </div>
    {% endfor %}

    {% for msg in app.session.flashbag.get('success') %}
        <div class="bs-callout bs-callout-success">
            <h4>{{ 'success.label'|trans }}</h4>
            <p>{{ msg|trans }}</p>
        </div>
    {% endfor %}

    {% if is_granted('ROLE_PREVIOUS_ADMIN') %}
        <div class="bs-callout bs-callout-warning">
            <h4>{{ 'profile.switch.active.title'|trans }}</h4>

            <p>
                {{ 'profile.switch.active.message'|trans({'%user%': app.user|user}) }}
            </p>

            <a href="?_switch_user=_exit" class="btn btn-primary btn-sm">
                <i class="fa fa-sign-out-alt"></i> {{ 'profile.switch.exit'|trans }}
            </a>
        </div>
    {% endif %}

    {% block content %}{% endblock %}
{% endblock %}

{% block footer_links %} â€“ <a href="{{ absolute_url('/docs/api/app') }}">{{ 'api.doc'|trans }}</a> {% endblock %}

{% block css %}
    <link rel="stylesheet" href="{{ asset('build/app.css') }}" type="text/css" />
{% endblock %}

{% block javascript %}
    <script src="{{ asset('build/app.js') }}"></script>
{% endblock %}
